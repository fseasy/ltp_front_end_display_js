<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <title>ltp analysis result display in JavaScript developping</title>
        <script type="text/javascript" src="./canvas_ex.js"> </script>
        <script type="text/javascript" src="./draw.js"> </script>
        <script type="text/javascript" src="./jquery-latest.js"> </script>
        <link rel="stylesheet" href="./bootstrap.min.css" />
        <style>
            .bg-blue{
                background-color : #0061c2 ;
                color : #FFFFFF ;
            }
            .result-display {
                height : 500px ;
                border : 1px solid #ccc ;
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="collapse navbar-collapse" >
                    <ul class="nav navbar-nav">
                        <li> <a href="javascript:return 0">新演示</a> </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="jumbotron bg-blue">
            <div class="container">
                <h1>新的演示</h1>
                <p>a new display for ltp-cloud . It is now in developping progress ! </p>
            </div>
        </div>
        <div class="container">
            <form class="form-horizontal" role="form">
                <div class="form-group">
                    <label for="inputText" class="sr-only">input text</label>
                    <div class="col-sm-10 ">
                        <textarea id="inputText" class="form-control" rows="3">我是中国人。</textarea>
                    </div>
                    <div class="col-sm-2">
                        <button type="submit" class="btn btn-primary" id="analysis">分析</button>
                    </div>
                </div>
            </form>
            <div class="row">
                <!--<div class="col-sm-12 result-display" id="rstDisplay">
                    
                </div> -->
                <div class="col-sm-12" >
                    <canvas id="canvasTest" width="500" height="500">
                        your browser does not support canvas element
                    </canvas>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            $(document).ready(function(){
                var rstDisplay = $("#rstDisplay") , 
                    analysisBtn ,
                    analysis ;
                

                analysis = function(){
                    var requestArgs = [] ,
                    postData ,
                    targetURL ;
                    
                    requestArgs["api_key"] = "U2G658z15u6Q4RpksQHC9KDevunLIypIHc5nPr5U" ;
                    requestArgs["pattern"] = "all" ;
                    requestArgs["format"] = "json" ;
                    requestArgs["text"] = encodeURI($("#inputText").val()) ;
                    postData = (function(){
                            var tmpStrArray = [] ;
                            for (key in requestArgs) {
                                tmpStrArray.push([key , requestArgs[key]].join("=")) ;
                            }
                            return tmpStrArray.join("&") ;
                    })() ;
                    targetURL = "http://ltpapi.voicecloud.cn/analysis/"
                    //ajax
                    $.ajax({
                        url : targetURL ,
                        type : "POST" ,
                        async : false ,
                        dataType : "jsonp" ,
                        data : postData ,
                        success : function(returnVal){
                            //console.log(returnVal) ;
                            //console.log(typeof returnVal) ;
                            //rstDisplay.html(returnVal[0][0][0]["cont"])
                            console.log(returnVal[0][0]) ;
                             drawMain(returnVal[0][0] , "canvasTest") ;
                            
                        } ,
                        error : function(errorInfo){
                            console.log(errorInfo) ;
                        }
                    }) ;
                    return false ;
                }
                analysis() ;
                analysisBtn = $("#analysis") ;
                analysisBtn.bind("click" , analysis ) ;
            }) ;
        </script>
    </body>
</html>